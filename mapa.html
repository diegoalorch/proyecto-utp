<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mapa</title>
    <link rel="stylesheet" href="css/mapa.css">
    <link rel="stylesheet" href="css/estilos.css">
    <link rel="stylesheet" href="font-awesome-4.7.0/css/font-awesome.min.css">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" crossorigin="anonymous">
</head>

<body style="max-width: 1500px;">
    <div class="main" style="width: 1349px !important;height: 585px !important;">
        <div id="" style="width: 1092.800px !important;">
            <div id="contenedorjuego" style="width: 1092.800px !important;">
                <div id="Menujuego">
                    <div id="carouselExampleControls" class="carousel slide" data-bs-interval="false" data-ride="carousel">
                        <div class="carousel-inner">
                            <div class="carousel-item active">
                                <div class="d-grid gap-2 nivelClass" style="background-size: contain; background-repeat: no-repeat; background-image: url(../img/mapa/m_facil.svg); height: 550px;">

                                    <div class="headermap">
                                        <h2 style=" text-align: center; color: rgb(117, 0, 0); margin-top: 10px; font-weight: bold;">Nivel 1</h2>
                                        <h2 style=" text-align: center; color: rgb(117, 0, 0); margin-top: 10px; font-weight: bold;" id="charter"></h2>
                                        <div class="score">
                                            <div class="score_title">Puntuaci√≥n</div>
                                            <div class="puntuacion">20</div>
                                        </div>
                                    </div>
                                    <div id="niveles-1">

                                    </div>
                                </div>
                            </div>
                            <div class="carousel-item">
                                <div class="d-grid gap-2 nivelClass " style="background-size: contain; background-repeat: no-repeat; background-image: url(./img/mapa/intermedio.jpg); height: 550px;">
                                    <div class="headermap">
                                        <h1 style=" text-align: center; color: rgb(117, 0, 0); margin-top: 10px; font-weight: bold; font-size: 2cm; ">Nivel 1</h1>
                                    </div>
                                    <div id="niveles-2">

                                    </div>
                                </div>
                            </div>
                            <div class="carousel-item">
                                <div class="d-grid gap-2 nivelClass" style="background-size: contain; background-repeat: no-repeat; background-image: url(../img/mapa/dificil.jpg); height: 550px;">
                                    <div class="headermap">
                                        <h1 style=" text-align: center; color: rgb(117, 0, 0); margin-top: 10px; font-weight: bold; font-size: 2cm; ">Nivel 1</h1>
                                    </div>
                                    <div id="niveles-3">

                                    </div>
                                </div>
                            </div>
                        </div>
                        <button onclick="prev()" style="padding-top:30px ; height: 30px;" class="carousel-control-prev" type="button" data-bs-target="#carouselExampleControls" data-bs-slide="prev">
                            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Previous</span>
                          </button>
                        <button onclick="next()" style="padding-top:30px ; height: 30px;" class="carousel-control-next" type="button" data-bs-target="#carouselExampleControls" data-bs-slide="next">
                            <span class="carousel-control-next-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Next</span>
                          </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-body">
                    Complete 3 preguntas correctas para desbloquear este nivel
                </div>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js " integrity="sha384-U1DAWAznBHeqEIlVSCgzq+c9gqGAJn5c/t99JyeKa9xxaYpSvHU5awsuZVVFIhvj " crossorigin="anonymous "></script>
    <script src="/js/data.js"></script>
    <script>
        const nivel_1 = document.querySelector("#niveles-1");
        const nivel_2 = document.querySelector("#niveles-2");
        const nivel_3 = document.querySelector("#niveles-3");
        const nivelesClass = document.getElementsByClassName("nivelClass")
        const myModal = new bootstrap.Modal(document.getElementById('exampleModal'))
        const puntos = localStorage.getItem('puntuacion');
        const charter = document.querySelector("#charter")
        const chart = localStorage.getItem('char')
        console.log(chart)

        function listar_pregunta(nivel, preguntas) {
            const personaje = chart.split(',')
            charter.innerHTML = personaje[0]
            for (let index = 0; index < (preguntas).length; index++) {
                if (preguntas[index].nivel == nivel) {
                    if (!preguntas[index].look) {
                        nivelesClass[index].className += " imagenfondo"
                    }
                    console.log(preguntas[index], nivelesClass[index])
                    for (let preg = 0; preg < preguntas[index].preguntas.length; preg++) {
                        const element = preguntas[index].preguntas[preg];
                        const div = document.createElement('div');
                        const i = document.createElement('i');

                        if (element.unlook) {
                            i.className = "fa fa-unlock icono"
                            div.style.cursor = "pointer";
                            i.setAttribute("onClick", "questionByNumber(" + (element.nro) + ")")
                        } else {
                            i.className = "fa fa-lock icono"
                            div.style.cursor = "not-allowed";

                        }
                        i.ariaHidden = "true"
                        div.className = "prueba" + (element.nro)
                        if (element.good) {
                            div.style.background = "green"
                        } else {
                            div.style.background = "red"
                        }


                        div.appendChild(i)
                        switch (nivel) {
                            case 1:
                                nivel_1.appendChild(div)
                                break;
                            case 2:
                                console.log("entre")
                                nivel_2.appendChild(div)
                                break;
                            case 3:
                                nivel_3.appendChild(div)
                                break;
                            default:
                                nivel_1.appendChild(div)
                                break;
                        }

                    }
                } else {
                    console.log(preguntas[index].preguntas)
                }
            }
        }

        function questionByNumber(numero) {
            localStorage.setItem('question', numero)
            location.href = "/jugando.html";
        }

        function clear() {
            const removerdiv1 = nivel_1.querySelectorAll('div');
            removerdiv1.forEach((div, i) => {
                nivel_1.removeChild(div)
            });
            const removerdiv2 = nivel_2.querySelectorAll('div');
            removerdiv2.forEach((div, i) => {
                nivel_2.removeChild(div)
            });
            const removerdiv3 = nivel_3.querySelectorAll('div');
            removerdiv3.forEach((div, i) => {
                nivel_3.removeChild(div)
            });
        }
        var nivel = 1;
        const preguntas = getPreguntas();
        listar_pregunta(1, preguntas)

        function validar() {
            if (puntos < 3) {
                myModal.show()
                setInterval(console.log("asd"), 2000);
            }

        }

        function next() {
            validar()
            clear()
            nivel++
            if (nivel > 3) {
                nivel = 1
            }

            listar_pregunta(nivel, preguntas)
            console.log(nivel)

        }

        function prev() {
            clear()
            nivel--
            if (nivel < 1) {
                nivel = 3
            }
            listar_pregunta(nivel, preguntas)
            console.log(nivel)
        }
    </script>
</body>

</html>